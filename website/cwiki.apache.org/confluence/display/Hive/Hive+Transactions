<!DOCTYPE html>
<html>
<head>
                    <title>Hive Transactions - Apache Hive - Apache Software Foundation</title>
    
        

                        
    
                        
    

                
    
    <meta http-equiv="X-UA-Compatible" content="IE=EDGE,chrome=IE7">
<meta charset="UTF-8">
<meta id="confluence-context-path" name="confluence-context-path" content="/confluence">
<meta id="confluence-base-url" name="confluence-base-url" content="https://cwiki.apache.org/confluence">

<meta id="atlassian-token" name="atlassian-token" content="735c8f668271f8e1dea73527ae5689ca93f07505">


<meta id="confluence-space-key" name="confluence-space-key" content="Hive">
<script type="text/javascript">
        var contextPath = '/confluence';
</script>

    

    <meta name="confluence-request-time" content="1451833173962">
        
    
        
            <meta name="ajs-is-space-admin" content=""> <meta name="ajs-has-space-config" content="">
            <style>.ia-fixed-sidebar, .ia-splitter-left {width: 285px;}.theme-default .ia-splitter #main {margin-left: 285px;}.ia-fixed-sidebar {visibility: hidden;}</style>
            <meta name="ajs-use-keyboard-shortcuts" content="true">
            <meta name="ajs-discovered-plugin-features" content="$discoveredList">
            <meta name="ajs-keyboardshortcut-hash" content="38450baaed51271899c8e867d2a48ca9">
            <meta name="ajs-is-confluence-admin" content="false">
            <meta name="ajs-connection-timeout" content="10000">
            <meta name="gliffy-license-type" content="LicenseType&lt;COMMUNITY&gt;">
<meta name="gliffy-license-quantity" content="${pluginLicenseManager.userCount}">

            <script type="text/x-template" title="gliffy-webpanel-footer">
        <div class="gliffy-webpanel-footer"><span>This Confluence installation runs a Free Gliffy License - Evaluate the <a href="http://www.gliffy.com/products/confluence-plugin/">Gliffy Confluence Plugin</a> for your Wiki!</span></div>
</script>


            
    
    
            <meta name="ajs-page-id" content="40509723">
            <meta name="ajs-latest-page-id" content="40509723">
            <meta name="ajs-content-type" content="page">
            <meta name="ajs-page-title" content="Hive Transactions">
            <meta name="ajs-parent-page-title" content="Home">
            <meta name="ajs-parent-page-id" content="27362069">
            <meta name="ajs-space-key" content="Hive">
            <meta name="ajs-space-name" content="Apache Hive">
            <meta name="ajs-jira-metadata-count" content="1">
            <meta name="ajs-jira-metadata-count-incomplete" content="false">
            <meta name="ajs-from-page-title" content="">
            <meta name="ajs-can-remove-page" content="false">
            <meta name="ajs-browse-page-tree-mode" content="view">
            <meta name="ajs-shared-drafts" content="false">
            <meta name="ajs-context-path" content="/confluence">
            <meta name="ajs-base-url" content="https://cwiki.apache.org/confluence">
            <meta name="ajs-version-number" content="5.8.4">
            <meta name="ajs-build-number" content="5982">
            <meta name="ajs-remote-user" content="">
            <meta name="ajs-remote-user-key" content="">
            <meta name="ajs-current-user-fullname" content="">
            <meta name="ajs-current-user-avatar-url" content="">
            <meta name="ajs-static-resource-url-prefix" content="/confluence/s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_">
            <meta name="ajs-global-settings-attachment-max-size" content="20971520">
            <meta name="ajs-user-locale" content="en_GB">
            <meta name="ajs-enabled-dark-features" content="confluence-inline-comments-resolved,notification.plugin.api.enabled.com.atlassian.confluence.plugins.sharepage.api.ShareContentEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.mentions.api.ConfluenceMentionEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.security.ForgotPasswordEvent,pdf-preview,notification.plugin.api.enabled.com.atlassian.confluence.plugins.tasklist.event.SendTaskEmailEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.page.async.PageMovedEvent,previews.sharing,previews.versions,notification.plugin.api.enabled.com.atlassian.confluence.plugins.files.notifications.event.FileContentUpdateEvent,file-annotations,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.attachment.AttachmentBatchUploadCompletedEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.comment.CommentCreateEvent,notification.plugin.api.enabled.com.atlassian.confluence.efi.emails.events.OnboardingLessUsersEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.files.notifications.event.FileContentRemoveEvent,atlassian.aui.raphael.disabled,previews.conversion-service,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.comment.CommentUpdateEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.follow.FollowEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.page.async.PageEditedEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.blogpost.BlogPostCreateEvent,previews.trigger-all-file-types,notification.plugin.api.enabled.com.atlassian.confluence.plugins.inlinecomments.events.InlineCommentResolveEvent,notification.plugin.api.enabled.com.atlassian.confluence.event.events.like.LikeCreatedEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.inlinecomments.events.InlineCommentCreateEvent,previews.sharing.pushstate,confluence-inline-comments-rich-editor,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.blogpost.BlogPostUpdateEvent,file-annotations.likes,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.page.async.PageCreatedEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.files.notifications.event.FileContentMentionUpdateEvent,notification.plugin.api.enabled.com.atlassian.confluence.efi.emails.events.OnboardingNoSpaceCreatedEvent,notification.plugin.api.enabled.com.atlassian.confluence.plugins.hipchat.api.events.HipChatUserMapped,notification.plugin.api.enabled.com.atlassian.confluence.plugins.sharepage.api.ShareAttachmentEvent,confluence-inline-comments,confluence-inline-comments-dangling-comment,notification.plugin.api.enabled.com.atlassian.confluence.event.events.content.blogpost.BlogPostMovedEvent">
            <meta name="ajs-atl-token" content="735c8f668271f8e1dea73527ae5689ca93f07505">
            <meta name="ajs-confluence-flavour" content="VANILLA">
            <meta name="ajs-user-date-pattern" content="dd MMM yyyy">
            <meta name="ajs-date.format" content="MMM dd, yyyy">
    
    <link rel="shortcut icon" href="../../s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/favicon.ico">
    <link rel="icon" type="image/x-icon" href="../../s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/favicon.ico">

<link rel="search" type="application/opensearchdescription+xml" href="https://cwiki.apache.org/confluence/opensearch/osd.action" title="Apache Software Foundation"/>
    
                    
            <meta name="ajs-create-issue-metadata-show-discovery" content="false">
            

<script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"/confluence\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-nps-plugin:atlassian-nps-plugin-resources.is-server-instance-data-provider"]="true";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:/confluence(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-license-banner:confluence-license-banner-resources.license-details"]="{\"daysBeforeLicenseExpiry\":0,\"daysBeforeMaintenanceExpiry\":0,\"showLicenseExpiryBanner\":false,\"showMaintenanceExpiryBanner\":false,\"renewUrl\":null,\"salesEmail\":null}";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-hipchat-integration-plugin:discovery-javascript-data.link-active"]="{\"linkActive\":true,\"conditionsMet\":true,\"admin\":false}";
WRM._unparsedData["com.atlassian.plugins.atlassian-nps-plugin:nps-acknowledgement-resources.analytics-enabled-data-provider"]="\"true\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-nps-plugin:nps-acknowledgement-resources.sen-data-provider"]="\"SEN-2015076\"";
WRM._unparsedData["com.atlassian.confluence.plugins.confluence-feature-discovery-plugin:confluence-feature-discovery-plugin-resources.test-mode"]="false";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api.feature-data-provider"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/2e51e60e83eadbb79c5004bd9c4ac765-CDN/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/68/_/download/superbatch/css/batch.css@build-number=5982" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/68/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/68/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/9b6bdeb7fddc0a2f5337e313f4e85615-T/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/ec13b76cd8d002fa2cf4ca229002aee7/_/download/contextbatch/css/page,viewcontent,atl.general,main,pagebanner,atl.comments/batch.css@highlightactions=true&amp;locale=en-GB&amp;flavour=VANILLA" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/confluence/s/6c0981174e94142364564819dc0d1413-CDN/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/ec13b76cd8d002fa2cf4ca229002aee7/_/download/contextbatch/css/page,viewcontent,atl.general,main,pagebanner,atl.comments/batch.css?conditionalComment=lt+IE+9&amp;locale=en-GB" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/2.8.6/_/download/batch/org.randombits.confluence.toc%253Atoc-plugin-styles/org.randombits.confluence.toc%253Atoc-plugin-styles.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/13/_/styles/colors.css@spaceKey=Hive" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/1.0/_/download/resources/com.atlassian.confluence.themes.default%253Astyles/default-theme.css" media="all">
<script type="text/javascript" src="../../s/b5b7f3c4a47ebde54b884c3070e3bb8c-CDN/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/68/_/download/superbatch/js/batch.js@atlassian.aui.raphael.disabled=true&amp;locale=en-GB&amp;build-number=5982" ></script>
<script type="text/javascript" src="../../s/47fb273cd38c3662368839aefb134f70-T/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/ec13b76cd8d002fa2cf4ca229002aee7/_/download/contextbatch/js/page,viewcontent,atl.general,main,pagebanner,atl.comments/batch.js@highlightactions=true&amp;analytics-uploadable=true&amp;flavour=VANILLA&amp;nps-acknowledged=true&amp;analytics-enabled=true&amp;locale=en-GB&amp;anonymous-access-enabled=true&amp;is-server-instance=true&amp;hostenabled=true" ></script>
<script type="text/javascript" src="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/2.8.6/_/download/batch/org.randombits.confluence.toc%253Aclient-side-toc-resources/org.randombits.confluence.toc%253Aclient-side-toc-resources.js" ></script>
<script type="text/javascript" src="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/2.8.6/_/download/batch/org.randombits.confluence.toc%253Atoc-plugin-analytics/org.randombits.confluence.toc%253Atoc-plugin-analytics.js" ></script>


        
    

        
        <meta name="ajs-site-title" content="Apache Software Foundation" />

    
    

    
                <link rel="canonical" href="Hive+Transactions">
        <link rel="shortlink" href="https://cwiki.apache.org/confluence/x/GyFqAg">
    <meta name="wikilink" content="[Hive:Hive Transactions]">
    <meta name="page-version" content="38">

</head>

<body             onload="placeFocus()"
     id="com-atlassian-confluence" class="theme-default  aui-layout aui-theme-default">

        
            <div id='stp-licenseStatus-banner'></div>
    <ul id="assistive-skip-links" class="assistive">
    <li><a href="Hive+Transactions#title-heading">Skip to content</a></li>
    <li><a href="Hive+Transactions#breadcrumbs">Skip to breadcrumbs</a></li>
    <li><a href="Hive+Transactions#header-menu-bar">Skip to header menu</a></li>
    <li><a href="Hive+Transactions#navigation">Skip to action menu</a></li>
    <li><a href="Hive+Transactions#quick-search-query">Skip to quick search</a></li>
</ul>
<div id="page">
<div id="full-height-container">
    <div id="header-precursor">
        <div class="cell">
            <style type="text/css">
#preview #previewArea iframe {

   overflow: visible;
}
</style>

                            </div>
    </div>
    



<header id="header" role="banner">
    <nav class="aui-header aui-dropdown2-trigger-group" role="navigation"><div class="aui-header-inner"><div class="aui-header-before"><a class=" aui-dropdown2-trigger app-switcher-trigger" aria-owns="app-switcher" aria-controls="app-switcher" aria-haspopup="true" data-aui-trigger href="Hive+Transactions#app-switcher"><span class="aui-icon aui-icon-small aui-iconfont-appswitcher">Linked Applications</span></a><div id="app-switcher" class="aui-dropdown2 aui-style-default"><div class="app-switcher-loading">Loading&hellip;</div></div><script>
            (function (NL) {
                var initialise = function () {
                    // For some milestones of AUI, the atlassian soy namespace was renamed to aui. Handle that here by ensuring that window.atlassian is defined.
                    window.atlassian = window.atlassian || window.aui;
                    new NL.AppSwitcher({
                        dropdownContents: '#app-switcher'
                    });
                };
                if (NL.AppSwitcher) {
                    initialise();
                } else {
                    NL.onInit = initialise;
                }
            }(window.NL = (window.NL || {})));
            window.NL.isUserAdmin = false</script></div><div class="aui-header-primary"><h1 id="logo" class="aui-header-logo aui-header-logo-custom"><a href="https://cwiki.apache.org/confluence/"><img src="../../s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/images/logo/confluence-logo.png" alt="Apache Software Foundation" /></a></h1><ul class="aui-nav">
                            <li>
            
        
        
<a  id="space-directory-link" href="https://cwiki.apache.org/confluence/spacedirectory/view.action"  class=" aui-nav-imagelink"   title="Spaces">
            <span>Spaces</span>
    </a>
        </li>
                        </ul>
</div><div class="aui-header-secondary"><ul class="aui-nav">
                        <li>
        <form id="quick-search" class="aui-quicksearch dont-default-focus header-quicksearch" action="https://cwiki.apache.org/confluence/dosearchsite.action" method="get"><fieldset><label for="quick-search-query" class="assistive">Quick Search</label><input id="quick-search-query" class="text app-search search quick-search-query" type="text" accessKey="q" autocomplete="off" name="queryString" title="Quick Search" placeholder="Search" /><input id="quick-search-submit" class="quick-search-submit" type="submit" value="Search"/><div class="aui-dd-parent quick-nav-drop-down"></div></fieldset></form>
    </li>
        <li>
            
        <a id="help-menu-link" class="aui-nav-link aui-dropdown2-trigger" href="Hive+Transactions#" aria-haspopup="true" aria-owns="help-menu-link-content" title="Help">
        <span class="aui-icon aui-icon-small aui-iconfont-help">Help</span>
    </a>
    <nav id="help-menu-link-content" class="aui-dropdown2 aui-style-default" aria-hidden="true">
                    <div class="aui-dropdown2-section">
                                <ul  id="help-menu-link-leading" class="aui-list-truncate section-leading first">
                                            <li>
        
            
<a  id="confluence-help-link" href="https://docs.atlassian.com/confluence/docs-58/Getting+Help+And+Support" class="    "      title="Visit the Confluence documentation home"  target="_blank"
>
        Online Help
</a>
</li>
                                            <li>
    
            
<a  id="keyboard-shortcuts-link" href="https://cwiki.apache.org/confluence" class="    "      title="View available keyboard shortcuts" >
        Keyboard Shortcuts
</a>
</li>
                                            <li>
    
            
<a  id="feed-builder-link" href="https://cwiki.apache.org/confluence/dashboard/configurerssfeed.action" class="    "      title="Create your custom RSS feed." >
        Feed Builder
</a>
</li>
                                            <li>
    
            
<a  id="whats-new-menu-link" href="https://docs.atlassian.com/confluence/docs-58/whatsnew/iframe" class="    "      title="" >
        What’s new
</a>
</li>
                                            <li>
    
            
<a  id="whats-new-menu-link" href="https://docs.atlassian.com/confluence/docs-58/whatsnew/iframe" class="    "      title="" >
        What’s new
</a>
</li>
                                            <li>
    
            
<a  id="gadget-directory-link" href="https://cwiki.apache.org/confluence" class="   user-item administration-link "      title="Browse gadgets provided by Confluence" >
        Available Gadgets
</a>
</li>
                                            <li>
    
            
<a  id="confluence-about-link" href="https://cwiki.apache.org/confluence/aboutconfluencepage.action" class="    "      title="Get more information about Confluence" >
        About Confluence
</a>
</li>
                                    </ul>
            </div>
            </nav>
    
    </li>
        <li>
                
    
    </li>
        <li>
            
    </li>
        <li>
                                            <li>
        
            
<a  id="login-link" href="https://cwiki.apache.org/confluence/login.action?os_destination=%2Fdisplay%2FHive%2FHive%2BTransactions" class="   user-item login-link "      title="" >
        Log in
</a>
</li>
                        <li>
    
            
<a  id="signup-link" href="https://cwiki.apache.org/confluence/signup.action" class="   user-item signup-link "      title="" >
        Sign up
</a>
</li>
                        
    </li>
    </ul>
</div></div><!-- .aui-header-inner--></nav><!-- .aui-header -->
    <br class="clear">
</header>

    
    	<div class="ia-splitter">
    		<div class="ia-splitter-left">
    			<div class="ia-fixed-sidebar">
    				
	    	<div class="acs-side-bar ia-scrollable-section"><div class="acs-side-bar-space-info tipsy-enabled" data-configure-tooltip="Edit space details"><div class="avatar"><div class="space-logo " data-key="Hive" data-name="Apache Hive" data-entity-type="confluence.space"><div class="avatar-img-container"><div class="avatar-img-wrapper"><a href="https://cwiki.apache.org/confluence/display/Hive" title="Apache Hive"><img class="avatar-img" src="../../download/attachments/27362113/Hive@version=2&amp;modificationDate=1317659390000&amp;api=v2" alt="Apache Hive"></a></div></div></div></div><div class="name"><a href="https://cwiki.apache.org/confluence/display/Hive" title="Apache Hive">Apache Hive</a></div><div class="flyout-handle icon"></div></div><div class="acs-side-bar-content"><div class="acs-nav-wrapper"><div class="acs-nav" data-has-create-permission="false" data-quick-links-state="null" data-nav-type="pages"><div class="acs-nav-sections"><div class="main-links-section "><ul class="acs-nav-list"><li class="acs-nav-item wiki current-item"data-collector-key="spacebar-pages"><a class="acs-nav-item-link tipsy-enabled" href="https://cwiki.apache.org/confluence/collector/pages.action?key=Hive" data-collapsed-tooltip="Pages"><span class="icon"></span><span class="acs-nav-item-label">Pages</span></a></li><li class="acs-nav-item blog"data-collector-key="spacebar-blogs"><a class="acs-nav-item-link tipsy-enabled" href="https://cwiki.apache.org/confluence/pages/viewrecentblogposts.action?key=Hive" data-collapsed-tooltip="Blog"><span class="icon"></span><span class="acs-nav-item-label">Blog</span></a></li></ul></div><div class="quick-links-wrapper"></div></div></div></div><div class="ia-secondary-container tipsy-enabled" data-tree-type="pages"><div class="ia-secondary-header"><h5 class="ia-secondary-header-title pages"><span class="label">Child pages</span></h5></div><div class="ia-secondary-parent-content"><ul class="parent ia-secondary-header-title wiki"><li class="parent-item"><a class="parent-item-link" href="Home" title="Home"><span class="icon"></span><span class="label">Home</span></a></li></ul></div><div class="ia-secondary-current-content"><ul class="ia-secondary-currentPage-title wiki current-item"><li><span class="icon"></span><span class="label">Hive Transactions</span></li></ul></div><div class="ia-secondary-content"><div class="contextual-nav-child-pages"></div></div></div></div><div class="hidden"><a href="https://cwiki.apache.org/confluence/collector/pages.action?key=Hive" id="space-pages-link"></a><script type="text/x-template" title="logo-config-content"><h2>Space Details</h2><div class="personal-space-logo-hint">Your profile picture is used as the logo for your personal space. <a href="https://cwiki.apache.org/confluence/users/profile/editmyprofilepicture.action" target="_blank">Change your profile picture</a>.</div></script></div></div><div class="space-tools-section"><div id="space-tools-menu-additional-items" class="hidden"><div data-label="Browse pages" data-class="" data-href="/confluence/pages/reorderpages.action?key=Hive">Browse pages</div></div><div id="space-tools-dd-dummy"></div><a id="space-tools-menu-trigger" class="aui-button aui-button-subtle aui-dropdown2-trigger tipsy-enabled" aria-owns="space-tools-dd-dummy"><span class="aui-icon aui-icon-small aui-iconfont-configure">Configure</span><span class="label">Space tools</span></a><a class="expand-collapse-trigger"></a></div>
    
    			</div>
    		</div>
        <!-- \#header -->

        
        <div id="main" class=" aui-page-panel">
                <div id="main-header">
            
    <div id="navigation" class="content-navigation view">
                    <ul class="ajs-menu-bar">
                                                        
                    
        <li class="normal ajs-menu-item">
        <a id="action-menu-link" class="action aui-dropdown2-trigger-arrowless aui-button aui-button-subtle ajs-menu-title aui-dropdown2-trigger" href="Hive+Transactions#" aria-haspopup="true" aria-owns="action-menu" data-container="#navigation">
            <span>
                                    <span class="aui-icon aui-icon-small aui-iconfont-more"></span>
                                
            </span>
        </a>         <div id="action-menu" class="aui-dropdown2 aui-style-default">
                            <ul  id="action-menu-primary"                     class="section-primary first aui-dropdown2-section">
                                            <li>

    
        
                                            
    
    
    <a  id="view-attachments-link" href="https://cwiki.apache.org/confluence/pages/viewpageattachments.action?pageId=40509723" rel="nofollow" class="action-view-attachments"  accessKey="t"  title="View Attachments">
                <span>
                        A<u>t</u>tachments (0)
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="action-view-history-link" href="https://cwiki.apache.org/confluence/pages/viewpreviousversions.action?pageId=40509723" rel="nofollow" class="action-view-history"   title="">
                <span>
                        Page History
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="action-page-permissions-link" href="https://cwiki.apache.org/confluence/pages/viewinfo.action?pageId=40509723" rel="nofollow" class="action-page-permissions"   title="Edit restrictions">
                <span>
                        Restrictions
        </span>    </a>
</li>
                                </ul>
                            <ul  id="action-menu-secondary"                     class="section-secondary aui-dropdown2-section">
                                            <li>

    
        
                                            
    
    
    <a  id="view-page-info-link" href="https://cwiki.apache.org/confluence/pages/viewinfo.action?pageId=40509723" rel="nofollow" class="action-view-info"   title="">
                <span>
                        Page Information
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="view-resolved-comments" href="https://cwiki.apache.org/confluence" rel="nofollow" class=""   title="">
                <span>
                        Resolved comments
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="link-to-page-link" href="https://cwiki.apache.org/confluence/pages/viewinfo.action?pageId=40509723" rel="nofollow" class=""   title="Link to this Page">
                <span>
                        Link to this Page…
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="view-in-hierarchy-link" href="https://cwiki.apache.org/confluence/pages/reorderpages.action?key=Hive&amp;openId=40509723#selectedPageInHierarchy" rel="nofollow" class=""   title="">
                <span>
                        View in Hierarchy
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="action-view-source-link" href="https://cwiki.apache.org/confluence/plugins/viewsource/viewpagesrc.action?pageId=40509723" rel="nofollow" class="action-view-source popup-link"   title="">
                <span>
                        View Source
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="delete-all-comments-link-link" href="https://cwiki.apache.org/confluence/plugins/aptis/deleteAllComments/ask-user.action?pageId=40509723" rel="nofollow" class=""   title="">
                <span>
                        Delete comments
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="action-export-pdf-link" href="https://cwiki.apache.org/confluence/spaces/flyingpdf/pdfpageexport.action?pageId=40509723" rel="nofollow" class=""   title="">
                <span>
                        Export to PDF
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="com-k15t-confluence-scroll-epub-launcher" href="https://cwiki.apache.org/confluence/pages/viewpage.action?pageId=40509723" rel="nofollow" class=""   title="">
                <span>
                        Export to EPUB
        </span>    </a>
</li>
                                        <li>

    
        
                                            
    
    
    <a  id="action-export-word-link" href="https://cwiki.apache.org/confluence/exportword?pageId=40509723" rel="nofollow" class="action-export-word"   title="">
                <span>
                        Export to Word
        </span>    </a>
</li>
                                </ul>
                            <ul  id="action-menu-modify"                     class="section-modify aui-dropdown2-section">
                                            <li>

    
        
                                            
    
    
    <a  id="treecopy-action" href="https://cwiki.apache.org/confluence/plugins/treecopy/setnames.action?pageId=40509723" rel="nofollow" class=""   title="">
                <span>
                        Copy Page Tree
        </span>    </a>
</li>
                                </ul>
                    </div>
    </li>
            </ul>
    </div>

            
            <div id="title-heading" class="pagetitle with-breadcrumbs">
                
                                    <div id="breadcrumb-section">
                        
    
    
    <ol id="breadcrumbs">
                                        
                        
        <li class="first" >
                        
                            <span class=""><a href="https://cwiki.apache.org/confluence/collector/pages.action?key=Hive">Pages</a></span>
                                                                    
                        
        <li>
                        
                            <span class=""><a href="Home">Home</a></span>
                                                    </ol>


                    </div>
                
                
        <a href="Hive+Transactions#page-banner-end" class="assistive">Skip to end of banner</a>
<div id="page-banner-start" class="assistive"></div>

                    
            <div id="page-metadata-banner"><ul class="banner"><li id="system-content-items" class="noprint"><a href="Hive+Transactions" title="Restrictions apply" id="content-metadata-page-restrictions" class="hidden"><img class="page-banner-item-icon" src="../../s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/download/resources/com.atlassian.confluence.plugins.confluence-page-banner%253Apage-banner-resources/images/red_padlock.png" style="height: 16px; width: 16px;"/></a></li><li class="page-metadata-item noprint has-button"  id="content-metadata-jira-wrapper"><a href="Hive+Transactions" title="" id="content-metadata-jira" class="aui-button aui-button-subtle content-metadata-jira tipsy-disabled hidden"><img class="page-banner-item-icon" src="../../s/en_GB/5982/f2b47fb3d636c8bc9fd0b11c0ec6d0ae18646be7.1/_/download/resources/com.atlassian.confluence.plugins.confluence-jira-metadata%253Aconfluence-jira-metadata-resources/img/icon-jira-link.png" style="height: 16px; width: 16px;"/><span>JIRA links</span></a></li></ul></div>
            

<a href="Hive+Transactions#page-banner-start" class="assistive">Go to start of banner</a>
<div id="page-banner-end" class="assistive"></div>
    

                <h1 id="title-text" class="with-breadcrumbs">
                                                <a href="Hive+Transactions">Hive Transactions</a>
                                    </h1>
            </div>
        </div><!-- \#main-header -->
        
        

        <div id="sidebar-container">
                                                </div><!-- \#sidebar-container -->

        
    

        




        

    
    
        
    
    
                    
    

                        
    
    

    




<div id="content" class="page view">
    


<div id="action-messages">
                        </div>



        <script type="text/x-template" title="searchResultsGrid">
    <table class="aui">
        <thead>
            <tr class="header">
                <th class="search-result-title">Page Title</th>
                <th class="search-result-space">Space</th>
                <th class="search-result-date">Updated</th>
            </tr>
        </thead>
    </table>
</script>
<script type="text/x-template" title="searchResultsGridCount">
    <p class="search-result-count">{0}</p>
</script>
<script type="text/x-template" title="searchResultsGridRow">
    <tr class="search-result">
        <td class="search-result-title"><a href="https://cwiki.apache.org/confluence/display/Hive/{1}" class="content-type-{2}"><span>{0}</span></a></td>
        <td class="search-result-space"><a class="space" href="https://cwiki.apache.org/confluence/display/{4}/" title="{3}">{3}</a></td>
        <td class="search-result-date"><span class="date" title="{6}">{5}</span></td>
    </tr>
</script>
        
    
            

        
                            
    

                    

        
        <a href="Hive+Transactions#page-metadata-end" class="assistive">Skip to end of metadata</a>
<div id="page-metadata-start" class="assistive"></div>

    <div class="page-metadata">
        <ul>
            <li class="page-metadata-modification-info">
                
        
    
        
    
        
        
            Created by <span class='author'>     <a href="https://cwiki.apache.org/confluence/display/~alangates"
                       class="url fn"
                            >Alan Gates</a></span>, last modified by <span class='editor'>     <a href="https://cwiki.apache.org/confluence/display/~wzheng"
                       class="url fn"
                            >Wei Zheng</a></span> on <a class='last-modified' title='Dec 14, 2015 22:12' href='https://cwiki.apache.org/confluence/pages/diffpagesbyversion.action?pageId=40509723&amp;selectedPageVersions=37&amp;selectedPageVersions=38'>Dec 14, 2015</a>
                </li>
        </ul>
    </div>


<a href="Hive+Transactions#page-metadata-start" class="assistive">Go to start of metadata</a>
<div id="page-metadata-end" class="assistive"></div>

        
                                            
        <div id="main-content" class="wiki-content">
                           
        <h1 class="p1" id="HiveTransactions-ACIDandTransactionsinHive">ACID and Transactions in Hive</h1><p><div class="toc-macro client-side-toc-macro " data-headerelements="H1,H2,H3,H4,H5,H6,H7"></div></p><h2 class="p6" id="HiveTransactions-WhatisACIDandwhyshouldyouuseit?">What is ACID and why should you use it?</h2><p class="p6">ACID stands for four traits of database transactions:  Atomicity (an operation either succeeds completely or fails, it does not leave partial data), Consistency (once an application performs an operation the results of that operation are visible to it in every subsequent operation), Isolation (operations by one user do not cause unexpected side effects for other users), and Durability (once an operation is complete it will be preserved even in the face of machine or system failure).  These traits have long been expected of database systems as part of their transaction functionality.  </p><p class="p6">Up until Hive 0.13, atomicity, consistency, and durability were provided at the partition level.  Isolation could be provided by turning on one of the available locking mechanisms (<a href="http://zookeeper.apache.org/" class="external-link" rel="nofollow">ZooKeeper</a> or in memory).  With the addition of transactions in <a href="https://issues.apache.org/jira/browse/HIVE-5317" class="external-link" rel="nofollow">Hive 0.13</a> it is now possible to provide full ACID semantics at the row level, so that one application can add rows while another reads from the same partition without interfering with each other.</p><p class="p6">Transactions with ACID semantics have been added to Hive to address the following use cases:</p><ol class="ol1"><li class="li6">Streaming ingest of data.  Many users have tools such as <a href="http://flume.apache.org/" class="external-link" rel="nofollow">Apache Flume</a>, <a href="https://storm.incubator.apache.org/" class="external-link" rel="nofollow">Apache Storm</a>, or <a href="http://kafka.apache.org/" class="external-link" rel="nofollow">Apache Kafka</a> that they use to stream data into their Hadoop cluster.  While these tools can write data at rates of hundreds or more rows per second, Hive can only add partitions every fifteen minutes to an hour.  Adding partitions more often leads quickly to an overwhelming number of partitions in the table.  These tools could stream data into existing partitions, but this would cause readers to get dirty reads (that is, they would see data written after they had started their queries) and leave many small files in their directories that would put pressure on the NameNode.  With this new functionality this use case will be supported while allowing readers to get a consistent view of the data and avoiding too many files.</li><li class="li6">Slow changing dimensions.  In a typical star schema data warehouse, dimensions<span class="s5"> </span>tables change slowly over time.  For example, a retailer will open new stores, which need to be added to the stores table, or an existing store may change its square footage or some other tracked characteristic.  These changes lead to inserts of individual records or updates<span class="s5"> </span>of records (depending on the strategy chosen).  Starting with 0.14, Hive is able to support this.</li><li class="li6">Data restatement.  Sometimes collected data is found to be incorrect and needs correction.  Or the first instance of the data may be an approximation (90% of servers reporting) with the full data provided later.  Or business rules may require that certain transactions be restated due to subsequent transactions (e.g., after making a purchase a customer may purchase a membership and thus be entitled to discount prices, including on the previous purchase).  Or a user may be contractually required to remove their customer’s data upon termination of their relationship.  Starting with Hive 0.14 these use cases can be supported via <em>INSERT, UPDATE</em>, and <em>DELETE</em>.</li></ol><h2 class="p6" id="HiveTransactions-Limitations">Limitations</h2><ul><li class="p6"><em>BEGIN</em>, <em>COMMIT</em>, and <em>ROLLBACK</em> are not yet supported.  All language operations are auto-commit.  The plan is to support these in a future release.</li><li class="p6">Only <a href="LanguageManual+ORC">ORC file format</a> is supported in this first release.  The feature has been built such that transactions can be used by any storage format that can determine how updates or deletes apply to base records (basically, that has an explicit or implicit row id), but so far the integration work has only been done for ORC.</li><li class="p6">By default transactions are configured to be off.  See the <a href="Hive+Transactions#HiveTransactions-Configuration">Configuration</a> section below for a discussion of which values need to be set to configure it.</li><li class="p6">Tables must be <a href="LanguageManual+DDL+BucketedTables">bucketed</a> to make use of these features.  Tables in the same system not using transactions and ACID do not need to be bucketed.</li><li class="p6">At this time only snapshot level isolation is supported.  When a given query starts it will be provided with a consistent snapshot of the data.  There is no support for dirty read, read committed, repeatable read, or serializable.  With the introduction of BEGIN the intention is to support<span class="s5"> </span>snapshot isolation for the duration of transaction rather than just a single query.  Other isolation levels may be added depending on user requests.</li><li class="p6">The existing ZooKeeper and in-memory lock managers are not compatible with transactions.  There is no intention to address this issue.  See <a href="Hive+Transactions#HiveTransactions-BasicDesign">Basic Design</a> below for a discussion of how locks are stored for transactions.</li><li class="p6">Schema changes using ALTER TABLE is NOT supported for ACID tables.  <a href="https://issues.apache.org/jira/browse/HIVE-11421" class="external-link" rel="nofollow">HIVE-11421</a> is tracking it.</li><li class="p6">Using Oracle as the Metastore DB and &quot;datanucleus.connectionPoolingType=BONECP&quot; may generate intermittent &quot;No such lock..&quot; and &quot;No such transaction...&quot; errors.  Setting &quot;datanucleus.connectionPoolingType=DBCP&quot; is recommended in this case. </li></ul><h2 class="p6" id="HiveTransactions-StreamingIngestInterface">Streaming Ingest Interface</h2><p class="p6">See the <a href="Streaming+Data+Ingest">Streaming Data Ingest</a> document for details on using streaming ingest.</p><h2 class="p6" id="HiveTransactions-GrammarChanges">Grammar Changes</h2><p class="p6"><em>INSERT...VALUES, UPDATE</em>, and <em>DELETE</em> have been added to the SQL grammar, starting in <a href="https://issues.apache.org/jira/browse/HIVE-5317" class="external-link" rel="nofollow">Hive 0.14</a>.  See <a href="LanguageManual+DML">LanguageManual DML</a> for details.</p><p class="p6">Several new commands have been added to Hive's DDL in support of ACID and transactions, plus some existing DDL has been modified.  </p><p class="p6">A new command <em>SHOW TRANSACTIONS</em> has been added, see <a href="LanguageManual+DDL#LanguageManualDDL-ShowTransactions">Show Transactions</a> for details.</p><p class="p6">A new command <em>SHOW COMPACTIONS</em> has been added, see <a href="LanguageManual+DDL#LanguageManualDDL-ShowCompactions">Show Compactions</a> for details.</p><p class="p6">The <em>SHOW LOCKS</em> command has been altered to provide information about the new locks associated with transactions.  If you are using the ZooKeeper or in-memory lock managers you will notice no difference in the output of this command.  See <a href="LanguageManual+DDL#LanguageManualDDL-ShowLocks">Show Locks</a> for details.</p><p class="p6">A new option has been added to <em>ALTER TABLE</em> to request a compaction of a table or partition.  In general users do not need to request compactions, as the system will detect the need for them and initiate the compaction.  However, if <a href="Hive+Transactions#HiveTransactions-TableProperties">compaction is turned off</a> for a table or a user wants to compact the table at a time the system would not choose to, <em>ALTER TABLE</em> can be used to initiate the compaction.  See <a href="LanguageManual+DDL#LanguageManualDDL-AlterTable/PartitionCompact">Alter Table/Partition Compact</a> for details.<span style="font-size: 14.0px;line-height: 1.4285715;">  This will enqueue a request for compaction and return.  To watch the progress of the compaction the user can use </span><em style="font-size: 14.0px;line-height: 1.4285715;">SHOW COMPACTIONS</em><span style="font-size: 14.0px;line-height: 1.4285715;">.</span></p><h2 class="p6" id="HiveTransactions-BasicDesign">Basic Design</h2><p class="p6">HDFS does not support in-place changes to files.  It also does not offer read consistency in the face of writers appending to files being read by a user.  In order to provide these features on top of HDFS we have followed the standard approach used in other data warehousing tools.  Data for the table or partition is stored in a set of base files.  New records, updates, and deletes are stored in delta files.  A new set of delta files is created for each transaction (or in the case of streaming agents such as Flume or Storm, each batch of transactions) that alters a table or partition.  At read time the reader merges the base and delta files, applying any updates and deletes as it reads.</p><h4 class="p6" id="HiveTransactions-DeltaFileCompaction">Delta File Compaction</h4><p class="p6">Occasionally these changes need to be merged into the base files.  To do this a set of threads has been added to the Hive metastore.  They determine when this compaction needs to be done, execute the compaction, and then clean up afterwards.  There are two types of compactions, minor and major.</p><ul><li class="p6">Minor compaction takes a set of existing delta files and rewrites them to a single delta file per bucket.</li><li class="p6">Major compaction takes one or more delta files and the base file for the bucket and rewrites them into a new base file per bucket.</li></ul><p class="p6">All compactions are done in the background and do not prevent concurrent reads and writes of the data.  After a compaction the system waits until all readers of the old files have finished and then removes the old files.</p><p class="p6">Compactions are MR jobs with name in the following form: &lt;hostname&gt;-compactor-&lt;db&gt;.&lt;table&gt;.&lt;partition&gt;</p><h4 class="p6" id="HiveTransactions-BaseandDeltaDirectories">Base and Delta Directories</h4><p class="p6">Previously all files for a partition (or a table if the table is not partitioned) lived in a single directory.  With these changes, any partitions (or tables) written with an ACID aware writer will have a directory for the base files and a directory for each set of delta files.</p><h4 class="p6" id="HiveTransactions-LockManager">Lock Manager</h4><p class="p6">A new lock manager has also been added to Hive, the DbLockManager.  This lock manager stores all lock information in the metastore.  In addition all transactions are stored in the metastore.  This means that transactions and locks are durable in the face of server failure.  To avoid clients dying and leaving transaction or locks dangling, a heartbeat is sent from lock holders and transaction initiators to the metastore on a regular basis.  If a heartbeat is not received in the configured amount of time, the lock or transaction will be aborted.</p><p class="p6">As of <a href="https://issues.apache.org/jira/browse/HIVE-12529" class="external-link" rel="nofollow">Hive 1.3.0</a>, the length of time that the DbLockManger will continue to try to acquire locks can be controlled via <a href="http://Configuration Properties#hive.lock.numretires" class="external-link" rel="nofollow">hive.lock.numretires</a> and <a href="http://Configuration Properties#hive.lock.sleep.between.retries" class="external-link" rel="nofollow">hive.lock.sleep.between.retries</a>.  When the DbLockManager cannot acquire a lock (due to existence of a competing lock), it will back off and try again after a certain time period.  In order to support short running queries and not overwhelm the metastore at the same time, the DbLockManager will double the wait time after each retry.  The initial back off time is 100ms and is capped by hive.lock.sleep.between.retries.  hive.lock.numretries is the total number of times it will retry a given lock request.  Thus the total time that the call to acquire locks will block (given default values of 10 retries and 60s sleep time) is (100ms + 200ms + 400ms + ... + 51200ms + 60s + 60s + ... + 60s) = 91m:42s:300ms.</p><p class="p6">More <a href="LanguageManual+DDL#LanguageManualDDL-ShowLocks" rel="nofollow">details</a> on locks used by this Lock Manager.</p><h2 class="p6" id="HiveTransactions-Configuration">Configuration</h2><p class="p6">These configuration parameters must be set appropriately to turn on transaction support in Hive:</p><ul><li class="p6"><span><a href="Configuration+Properties#ConfigurationProperties-hive.support.concurrency">hive.support.concurrency</a> – true</span></li><li class="p6"><span><a href="Configuration+Properties#ConfigurationProperties-hive.enforce.bucketing">hive.enforce.bucketing</a> – true (Not required as of <a href="https://issues.apache.org/jira/browse/HIVE-12331" class="external-link" rel="nofollow">Hive 2.0</a>)</span></li><li class="p6"><span><a href="Configuration+Properties#ConfigurationProperties-hive.exec.dynamic.partition.mode">hive.exec.dynamic.partition.mode</a> – nonstrict</span></li><li class="p6"><span><a href="Configuration+Properties#ConfigurationProperties-hive.txn.manager">hive.txn.manager</a> – <span>org.apache.hadoop.hive.ql.lockmgr.DbTxnManager</span></span></li><li class="p6"><span><span><span><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.initiator.on">hive.compactor.initiator.on</a> – <span>true (for exactly one instance of the Thrift metastore service)</span></span></span></span></li><li class="p6"><span><span><span><span><span><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.worker.threads">hive.compactor.worker.threads</a> – a positive number<span> on at least one instance of the Thrift metastore service</span></span></span></span></span></span></li></ul><p class="p6">The following sections list all of the configuration parameters that affect Hive transactions and compaction.  Also see <a href="Hive+Transactions#HiveTransactions-Limitations">Limitations</a> above and <a href="Hive+Transactions#HiveTransactions-TableProperties">Table Properties</a> below.</p><h3 class="p6" id="HiveTransactions-NewConfigurationParametersforTransactions">New Configuration Parameters for Transactions</h3><p class="p6">A number of new configuration parameters have been added to the system to support transactions.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><td class="confluenceTd"><p class="p6"><strong>Configuration key</strong></p></td><td class="confluenceTd"><p class="p6"><strong>Values</strong></p></td><td colspan="1" class="confluenceTd"><strong>Location</strong></td><td class="confluenceTd"><p class="p6"><strong>Notes</strong></p></td></tr><tr><td class="confluenceTd"><p class="p6"><a href="Configuration+Properties#ConfigurationProperties-hive.txn.manager">hive.txn.manager</a> </p></td><td class="confluenceTd"><p class="p6"><em>Default:</em> org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager</p><p class="p6"><em>Value required for transactions:</em> <span>org.apache.hadoop.hive.ql.lockmgr.DbTxnManager</span></p></td><td colspan="1" class="confluenceTd"><p>Client/<br /><span style="font-size: 14.0px;line-height: 1.4285715;">HiveServer2</span></p></td><td class="confluenceTd"><p class="p6">DummyTxnManager replicates pre Hive-0.13 behavior and provides no transactions.</p></td></tr><tr><td class="confluenceTd"><p class="p6"><a href="Configuration+Properties#ConfigurationProperties-hive.txn.timeout">hive.txn.timeout</a> </p></td><td class="confluenceTd"><p class="p6"><em>Default: </em>300</p></td><td colspan="1" class="confluenceTd"><p>Client/<br />HiveServer2/</p><p>Metastore </p></td><td class="confluenceTd"><p class="p6">Time after which transactions are declared aborted if the client has not sent a heartbeat, in seconds. It's critical that this property has the same value for all components/services.<sup>5</sup></p></td></tr><tr><td colspan="1" class="confluenceTd"><a href="Configuration+Properties#ConfigurationProperties-hive.timedout.txn.reaper.start">hive.timedout.txn.reaper.start</a></td><td colspan="1" class="confluenceTd"><em>Default:</em> <span>100s</span></td><td colspan="1" class="confluenceTd">Metastore</td><td colspan="1" class="confluenceTd">Time delay of first reaper (the process which aborts timed-out transactions) run after the metastore starts (as of <a href="https://issues.apache.org/jira/browse/HIVE-11317" class="external-link" rel="nofollow">Hive 1.3.0</a>).</td></tr><tr><td colspan="1" class="confluenceTd"><p><a href="Configuration+Properties#ConfigurationProperties-hive.timedout.txn.reaper.interval">hive.timedout.txn.reaper.interval</a></p></td><td colspan="1" class="confluenceTd"><em>Default:</em> <span style="line-height: 1.4285715;">180s</span></td><td colspan="1" class="confluenceTd">Metastore</td><td colspan="1" class="confluenceTd"><p>Time interval describing how often the reaper (the process which aborts timed-out transactions) runs (as of <a href="https://issues.apache.org/jira/browse/HIVE-11317" class="external-link" rel="nofollow">Hive 1.3.0</a>).</p></td></tr><tr><td class="confluenceTd"><p class="p6"><a href="Configuration+Properties#ConfigurationProperties-hive.txn.max.open.batch">hive.txn.max.open.batch</a></p></td><td class="confluenceTd"><p class="p6"><em>Default: </em>1000</p></td><td colspan="1" class="confluenceTd">Client</td><td class="confluenceTd"><p class="p6">Maximum number of transactions that can be fetched in one call to open_txns().<sup>1</sup></p></td></tr><tr><td class="confluenceTd"><p class="p6"><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.initiator.on">hive.compactor.initiator.on</a></p></td><td class="confluenceTd"><p class="p6"><em>Default: </em>false</p><p class="p6"><span><em>Value required for transactions:</em> <span>true (for exactly one instance of the Thrift metastore service)</span></span></p></td><td colspan="1" class="confluenceTd">Metastore</td><td class="confluenceTd"><p class="p6">Whether to run the initiator and cleaner threads on this metastore instance. <u>It's critical that this is enabled on exactly one metastore service instance (not enforced yet)</u>.</p><p class="p7"> </p></td></tr><tr><td class="confluenceTd"><p class="p6"><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.worker.threads">hive.compactor.worker.threads</a></p></td><td class="confluenceTd"><p class="p6"><em>Default: </em>0</p><p class="p6"><span><em>Value required for transactions:</em> <span>&gt; 0 on at least one instance of the Thrift metastore service</span></span></p></td><td colspan="1" class="confluenceTd">Metastore</td><td class="confluenceTd"><p class="p6">How many compactor worker threads to run on this metastore instance.<sup>2</sup></p></td></tr><tr><td class="confluenceTd"><p class="p6"><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.worker.timeout">hive.compactor.worker.timeout</a></p></td><td class="confluenceTd"><p class="p6"><em>Default: </em>86400</p></td><td colspan="1" class="confluenceTd">Metastore</td><td class="confluenceTd"><p class="p6">Time in seconds after which a compaction job will be declared failed and the compaction re-queued.</p></td></tr><tr><td colspan="1" class="confluenceTd"><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.cleaner.run.interval">hive.compactor.cleaner.run.interval</a></td><td colspan="1" class="confluenceTd"><em>Default</em>: 5000</td><td colspan="1" class="confluenceTd">Metastore</td><td colspan="1" class="confluenceTd">Time in milliseconds between runs of the cleaner thread. (<a href="https://issues.apache.org/jira/browse/HIVE-8258" class="external-link" rel="nofollow">Hive 0.14.0</a> and later.)</td></tr><tr><td class="confluenceTd"><p class="p6"><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.check.interval">hive.compactor.check.interval</a></p></td><td class="confluenceTd"><p class="p6"><em>Default: </em>300</p></td><td colspan="1" class="confluenceTd">Metastore</td><td class="confluenceTd"><p class="p6">Time in seconds between checks to see if any tables or partitions need to be compacted.<sup>3</sup></p></td></tr><tr><td class="confluenceTd"><p class="p6"><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.delta.num.threshold">hive.compactor.delta.num.threshold</a></p></td><td class="confluenceTd"><p class="p6"><em>Default: </em>10</p></td><td colspan="1" class="confluenceTd">Metastore</td><td class="confluenceTd"><p class="p6">Number of delta directories in a table or partition that will trigger a minor compaction.</p></td></tr><tr><td class="confluenceTd"><p class="p6"><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.delta.pct.threshold">hive.compactor.delta.pct.threshold</a></p></td><td class="confluenceTd"><p class="p6"><em>Default: </em>0.1</p></td><td colspan="1" class="confluenceTd">Metastore</td><td class="confluenceTd"><p class="p6">Percentage (fractional) size of the delta files relative to the base that will trigger a major compaction. 1 = 100%, so the default 0.1 = 10%.</p></td></tr><tr><td class="confluenceTd"><p class="p6"><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.abortedtxn.threshold">hive.compactor.abortedtxn.threshold</a></p></td><td class="confluenceTd"><p class="p6"><em>Default: </em>1000</p></td><td colspan="1" class="confluenceTd">Metastore</td><td class="confluenceTd"><p class="p6">Number of aborted transactions involving a given table or partition that will trigger a major compaction.</p></td></tr><tr><td colspan="1" class="confluenceTd"><p><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.max.num.delta">hive.compactor.max.num.delta</a></p></td><td colspan="1" class="confluenceTd">Default: 500</td><td colspan="1" class="confluenceTd"><span>Metastore</span></td><td colspan="1" class="confluenceTd">Maximum number of delta files that the compactor will attempt to handle in a single job <span>(as of </span><a href="https://issues.apache.org/jira/browse/HIVE-11540" class="external-link" rel="nofollow">Hive 1.3.0</a><span>)</span>.<sup>4</sup></td></tr><tr><td colspan="1" class="confluenceTd"><p><a href="Configuration+Properties#ConfigurationProperties-hive.compactor.job.queue">hive.compactor.job.queue</a></p></td><td colspan="1" class="confluenceTd"><em>Default</em>: &quot;&quot; (empty string)</td><td colspan="1" class="confluenceTd"> Metastore</td><td colspan="1" class="confluenceTd"> Used to specify name of Hadoop queue to which Compaction jobs will be submitted. Set to empty string to let Hadoop choose the queue <span>(as of </span><a href="https://issues.apache.org/jira/browse/HIVE-11997" class="external-link" rel="nofollow">Hive 1.3.0</a><span>).</span></td></tr></tbody></table></div><p class="p6"><span><span><sup>1</sup>hive.txn.max.open.batch</span> controls how many transactions streaming agents such as Flume or Storm open simultaneously.  The streaming agent then writes that number of entries into a single file (per Flume agent or Storm bolt).  Thus increasing this value decreases the number of delta files created by streaming agents.  But it also increases the number of open transactions that Hive has to track at any given time, which may negatively affect read performance.</span></p><p class="p6"><span> </span><sup>2</sup><span>Worker threads spawn MapReduce jobs to do compactions.  They do not do the compactions themselves.  Increasing the number of worker threads will decrease the time it takes tables or partitions to be compacted once they are determined to need compaction.  It will also increase the background load on the Hadoop cluster as more MapReduce jobs will be running in the background.</span></p><p class="p6"><sup>3</sup><span>Decreasing this value will reduce the time it takes for compaction to be started for a table or partition that requires compaction.  However, checking if compaction is needed requires several calls to the NameNode for each table or partition that has had a transaction done on it since the last major compaction.  So decreasing this value will increase the load on the NameNode.</span></p><p class="p6"><span><sup>4</sup>If the compactor detects a very high number of delta files, it will first run several partial minor compactions (currently sequentially) and then perform the compaction actually requested.</span></p><p class="p6"><span><sup>5</sup>If the value is not the same active transactions may be determined to be &quot;timed out&quot; and consequently Aborted.  This will result in errors like &quot;No such transaction...&quot;, &quot;No such lock ...&quot;</span></p><h3 class="p6" id="HiveTransactions-ConfigurationValuestoSetforINSERT,UPDATE,DELETE">Configuration Values to Set for <em>INSERT, UPDATE, DELETE</em></h3><p>In addition to the new parameters listed above, some existing parameters need to be set to support <em>INSERT ... VALUES, UPDATE, </em>and <em>DELETE</em>.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Configuration key</th><th class="confluenceTh">Must be set to</th></tr><tr><td colspan="1" class="confluenceTd"><span><a href="Configuration+Properties#ConfigurationProperties-hive.support.concurrency">hive.support.concurrency</a></span></td><td colspan="1" class="confluenceTd">true (default is false)</td></tr><tr><td class="confluenceTd"><a href="Configuration+Properties#ConfigurationProperties-hive.enforce.bucketing">hive.enforce.bucketing</a></td><td class="confluenceTd">true (default is false) (Not required as of <a href="https://issues.apache.org/jira/browse/HIVE-12331" class="external-link" rel="nofollow">Hive 2.0</a>)</td></tr><tr><td colspan="1" class="confluenceTd"><a href="Configuration+Properties#ConfigurationProperties-hive.exec.dynamic.partition.mode">hive.exec.dynamic.partition.mode</a></td><td colspan="1" class="confluenceTd">nonstrict (default is strict)</td></tr></tbody></table></div><h3 class="p6" id="HiveTransactions-ConfigurationValuestoSetforCompaction">Configuration Values to Set for Compaction</h3><p>If the data in your system is not owned by the Hive user (i.e., the user that the Hive metastore runs as), then Hive will need permission to run as the user who owns the data in order to perform compactions.  If you have already set up HiveServer2 to impersonate users, then the only additional work to do is assure that Hive has the right to impersonate users from the host running the Hive metastore.  This is done by adding the hostname to <code>hadoop.proxyuser.hive.hosts</code> in Hadoop's <code>core-site.xml</code> file.  If you have not already done this, then you will need to configure Hive to act as a proxy user.  This requires you to set up keytabs for the user running the Hive metastore and add <code>hadoop.proxyuser.hive.hosts</code> and <code>hadoop.proxyuser.hive.groups</code> to Hadoop's <code>core-site.xml</code> file.  See the Hadoop documentation on secure mode for your version of Hadoop (e.g., for Hadoop 2.5.1 it is at <a href="http://hadoop.apache.org/docs/r2.5.1/hadoop-project-dist/hadoop-common/SecureMode.html" class="external-link" rel="nofollow">Hadoop in Secure Mode</a>).</p><h2 class="p6" id="HiveTransactions-TableProperties">Table Properties</h2><p>If a table is to be used in ACID writes (insert, update, delete) then the table property &quot;<code>transactional=true</code>&quot; must be set on that table, starting with <a href="https://issues.apache.org/jira/browse/HIVE-8290" class="external-link" rel="nofollow">Hive 0.14.0</a>.  Without this value, inserts will be done in the old style; updates and deletes will be prohibited.  However, this does not apply to Hive 0.13.0.</p><p class="p6">If a table owner does not wish the system to automatically determine when to compact, then the table property &quot;<code>NO_AUTO_COMPACTION</code>&quot; can be set.  This will prevent all automatic compactions.  Manual compactions can still be done with <a href="LanguageManual+DDL#LanguageManualDDL-AlterTable/PartitionCompact">Alter Table/Partition Compact</a> statements.</p><p class="p6">Table properties are set with the TBLPROPERTIES clause when a table is created or altered, as described in the <a href="LanguageManual+DDL#LanguageManualDDL-CreateTable">Create Table</a> and <a href="LanguageManual+DDL#LanguageManualDDL-AlterTableProperties">Alter Table Properties</a> sections of Hive Data Definition Language.  Currently the &quot;<code>transactional</code>&quot; and &quot;<code>NO_AUTO_COMPACTION</code>&quot; table properties are case-sensitive, although that will change in a future release with <a href="https://issues.apache.org/jira/browse/HIVE-8308" class="external-link" rel="nofollow">HIVE-8308</a>.</p><p class="p2"> </p>

                
        
    
        </div>

        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
         xmlns:dc="http://purl.org/dc/elements/1.1/"
         xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
         <rdf:Description
    rdf:about="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions"
    dc:identifier="https://cwiki.apache.org/confluence/display/Hive/Hive+Transactions"
    dc:title="Hive Transactions"
    trackback:ping="https://cwiki.apache.org/confluence/rpc/trackback/40509723"/>
</rdf:RDF>
-->

                        
    



<div id="labels-section" class="pageSection group">
    <div class="labels-section-content content-column" entityid="40509723" entitytype="page">
	<div class="labels-content">
		
    <ul class="label-list label-list-right ">
            <li class="no-labels-message">
            No labels
        </li>
            </ul>

    </div>
</div>
</div>
        
		
            




            
    








                        
    
<div id="comments-section" class="pageSection group">
        
    



</div>


                
    
            
</div>


    




    
    

    
    
    


    
<div id="space-tools-web-items" class="hidden">
                <div data-label="Overview" data-href="/confluence/spaces/viewspacesummary.action?key=Hive">Overview</div>
            <div data-label="Content Tools" data-href="/confluence/pages/reorderpages.action?key=Hive">Content Tools</div>
            <div data-label="Add-ons" data-href="/confluence/spaces/snippeterrors.action?key=Hive">Add-ons</div>
    </div>




    </div><!-- \#main -->
        
    
        
            
            

<div id="footer" role="contentinfo">
    <section class="footer-body">

                                                            <p class="license license-opensource">
                    Powered by a free <b>Atlassian Confluence Open Source Project License</b> granted to Apache Software Foundation. <a href="http://www.atlassian.com/c/conf/11461">Evaluate Confluence today</a>.<br>
                </p>
                    
        

        <ul id="poweredby">
            <li class="noprint">Powered by <a href="http://www.atlassian.com/software/confluence" class="hover-footer-link">Atlassian Confluence</a> <span id='footer-build-information'>5.8.4</span>, <a href="http://www.atlassian.com/software/confluence/overview/team-collaboration-software?utm_source=confluence-footer" class="hover-footer-link">Team Collaboration Software</a></li>
            <li class="print-only">Printed by Atlassian Confluence 5.8.4, Team Collaboration Software.</li>
            <li class="noprint"><a href="https://jira.atlassian.com/browse/CONF" class="hover-footer-link">Report a bug</a></li>
            <li class="noprint"><a href="http://www.atlassian.com/about/connected.jsp?s_kwcid=Confluence-stayintouch" class="hover-footer-link">Atlassian News</a></li>
        </ul>

        

        <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>

                    
        
    </section>
</div>

    
</div>

</div><!-- \#full-height-container -->
</div><!-- \#page -->
</body>
</html>
